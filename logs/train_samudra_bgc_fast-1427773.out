2025-09-06 23:22:17,660 - INFO - | distributed init (rank 1), gpu 1, world_size 4, dist_url env://
2025-09-06 23:22:17,722 - INFO - | distributed init (rank 2), gpu 2, world_size 4, dist_url env://
2025-09-06 23:22:18,215 - INFO - | distributed init (rank 0), gpu 0, world_size 4, dist_url env://
2025-09-06 23:22:18,654 - INFO - | distributed init (rank 3), gpu 3, world_size 4, dist_url env://
NCCL version 2.19.3+cuda12.3
2025-09-06 23:22:20,139 - INFO - Prognostic variables: CT_0, CT_1, CT_2, CT_3, CT_4, CT_5, CT_6, CT_7, CT_8, CT_9, CT_10, CT_11, CT_12, CT_13, CT_14, CT_15, CT_16, CT_17, CT_18, CT_19, CT_20, CT_21, CT_22, CT_23, CT_24, CT_25, CT_26, CT_27, CT_28, CT_29, CT_30, CT_31, CT_32, CT_33, CT_34, CT_35, CT_36, CT_37, CT_38, CT_39, CT_40, CT_41, CT_42, CT_43, SA_0, SA_1, SA_2, SA_3, SA_4, SA_5, SA_6, SA_7, SA_8, SA_9, SA_10, SA_11, SA_12, SA_13, SA_14, SA_15, SA_16, SA_17, SA_18, SA_19, SA_20, SA_21, SA_22, SA_23, SA_24, SA_25, SA_26, SA_27, SA_28, SA_29, SA_30, SA_31, SA_32, SA_33, SA_34, SA_35, SA_36, SA_37, SA_38, SA_39, SA_40, SA_41, SA_42, SA_43, o2_0, o2_1, o2_2, o2_3, o2_4, o2_5, o2_6, o2_7, o2_8, o2_9, o2_10, o2_11, o2_12, o2_13, o2_14, o2_15, o2_16, o2_17, o2_18, o2_19, o2_20, o2_21, o2_22, o2_23, o2_24, o2_25, o2_26, o2_27, o2_28, o2_29, o2_30, o2_31, o2_32, o2_33, o2_34, o2_35, o2_36, o2_37, o2_38, o2_39, o2_40, o2_41, o2_42, o2_43, dic_0, dic_1, dic_2, dic_3, dic_4, dic_5, dic_6, dic_7, dic_8, dic_9, dic_10, dic_11, dic_12, dic_13, dic_14, dic_15, dic_16, dic_17, dic_18, dic_19, dic_20, dic_21, dic_22, dic_23, dic_24, dic_25, dic_26, dic_27, dic_28, dic_29, dic_30, dic_31, dic_32, dic_33, dic_34, dic_35, dic_36, dic_37, dic_38, dic_39, dic_40, dic_41, dic_42, dic_43
2025-09-06 23:22:20,143 - INFO - Boundary variables: tauuo, tauvo, Qnet
2025-09-06 23:22:20,143 - INFO - Levels: 44
2025-09-06 23:22:20,148 - INFO - Number of inputs: (hist + 1) * prognostic_vars + boundary_vars = 355
2025-09-06 23:22:20,148 - INFO - Number of outputs: (hist + 1) * prognostic_vars = 352
2025-09-06 23:22:20,148 - INFO - Loading data
2025-09-06 23:22:22,336 - INFO - Instantiating model samudra_bgc
[23:22:22.353570] SamudraBGC init - Wet mask shape: torch.Size([352, 270, 180])
[23:22:22.353616] Expected spatial dims based on data: y=270, x=180
2025-09-06 23:22:25,572 - INFO - Loss = mse
2025-09-06 23:22:26,856 - INFO - Inference will use input at time 2024-01-01T00:00:00.000000000 and produce output at 2024-01-03T00:00:00.000000000
2025-09-06 23:22:26,872 - INFO - 
=== Warning Details ===
2025-09-06 23:22:26,872 - INFO - Message: This DataLoader will create 64 worker processes in total. Our suggested max number of worker in current system is 32, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
2025-09-06 23:22:26,872 - INFO - Category: <class 'UserWarning'>
2025-09-06 23:22:26,872 - INFO - File: /home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py
2025-09-06 23:22:26,872 - INFO - Line: 558
2025-09-06 23:22:26,872 - INFO - 
Full stack trace:
2025-09-06 23:22:26,881 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 631, in <module>
2025-09-06 23:22:26,881 - INFO -     main()
2025-09-06 23:22:26,881 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 621, in main
2025-09-06 23:22:26,882 - INFO -     trainer = Trainer(cfg)
2025-09-06 23:22:26,882 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 221, in __init__
2025-09-06 23:22:26,882 - INFO -     self.init_inference_stores()
2025-09-06 23:22:26,882 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 279, in init_inference_stores
2025-09-06 23:22:26,882 - INFO -     self.inference_loader = DataLoader(
2025-09-06 23:22:26,884 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 378, in __init__
2025-09-06 23:22:26,884 - INFO -     self.check_worker_number_rationality()
2025-09-06 23:22:26,884 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 558, in check_worker_number_rationality
2025-09-06 23:22:26,884 - INFO -     warnings.warn(_create_warning_msg(
2025-09-06 23:22:26,884 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/warnings.py", line 109, in _showwarnmsg
2025-09-06 23:22:26,884 - INFO -     sw(msg.message, msg.category, msg.filename, msg.lineno,
2025-09-06 23:22:26,884 - INFO - =====================

2025-09-06 23:22:26,885 - INFO - Starting training at step 4
2025-09-06 23:22:30,968 - INFO - Instantiating torch loaders
2025-09-06 23:22:30,968 - INFO - 
=== Warning Details ===
2025-09-06 23:22:30,968 - INFO - Message: This DataLoader will create 64 worker processes in total. Our suggested max number of worker in current system is 32, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
2025-09-06 23:22:30,968 - INFO - Category: <class 'UserWarning'>
2025-09-06 23:22:30,969 - INFO - File: /home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py
2025-09-06 23:22:30,969 - INFO - Line: 558
2025-09-06 23:22:30,969 - INFO - 
Full stack trace:
2025-09-06 23:22:30,971 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 631, in <module>
2025-09-06 23:22:30,971 - INFO -     main()
2025-09-06 23:22:30,971 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 624, in main
2025-09-06 23:22:30,971 - INFO -     trainer.run()
2025-09-06 23:22:30,971 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 298, in run
2025-09-06 23:22:30,971 - INFO -     self.init_data_loaders(cur_step)
2025-09-06 23:22:30,971 - INFO -   File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 519, in init_data_loaders
2025-09-06 23:22:30,971 - INFO -     self.train_loader = DataLoader(
2025-09-06 23:22:30,971 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 378, in __init__
2025-09-06 23:22:30,971 - INFO -     self.check_worker_number_rationality()
2025-09-06 23:22:30,971 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 558, in check_worker_number_rationality
2025-09-06 23:22:30,971 - INFO -     warnings.warn(_create_warning_msg(
2025-09-06 23:22:30,971 - INFO -   File "/home/mk0964/.conda/envs/samudra/lib/python3.10/warnings.py", line 109, in _showwarnmsg
2025-09-06 23:22:30,971 - INFO -     sw(msg.message, msg.category, msg.filename, msg.lineno,
2025-09-06 23:22:30,971 - INFO - =====================

