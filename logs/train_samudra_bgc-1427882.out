2025-09-07 08:52:03,832 - INFO - | distributed init (rank 0), gpu 0, world_size 4, dist_url env://
2025-09-07 08:52:04,319 - INFO - | distributed init (rank 3), gpu 3, world_size 4, dist_url env://
2025-09-07 08:52:04,323 - INFO - | distributed init (rank 2), gpu 2, world_size 4, dist_url env://
tiger-i04g1:650259:650259 [0] NCCL INFO Bootstrap : Using ib0:10.36.54.40<0>
tiger-i04g1:650259:650259 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
tiger-i04g1:650259:650259 [0] NCCL INFO cudaDriverVersion 13000
NCCL version 2.19.3+cuda12.3
tiger-i04g1:650262:650262 [3] NCCL INFO cudaDriverVersion 13000
tiger-i04g1:650262:650262 [3] NCCL INFO Bootstrap : Using ib0:10.36.54.40<0>
tiger-i04g1:650262:650262 [3] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
tiger-i04g1:650261:650261 [2] NCCL INFO cudaDriverVersion 13000
tiger-i04g1:650261:650261 [2] NCCL INFO Bootstrap : Using ib0:10.36.54.40<0>
tiger-i04g1:650261:650261 [2] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
2025-09-07 08:52:04,337 - INFO - | distributed init (rank 1), gpu 1, world_size 4, dist_url env://
tiger-i04g1:650260:650260 [1] NCCL INFO cudaDriverVersion 13000
tiger-i04g1:650260:650260 [1] NCCL INFO Bootstrap : Using ib0:10.36.54.40<0>
tiger-i04g1:650260:650260 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
tiger-i04g1:650262:650324 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:10.36.54.40<0>
tiger-i04g1:650261:650325 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:10.36.54.40<0>
tiger-i04g1:650259:650323 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:10.36.54.40<0>
tiger-i04g1:650261:650325 [2] NCCL INFO Using non-device net plugin version 0
tiger-i04g1:650262:650324 [3] NCCL INFO Using non-device net plugin version 0
tiger-i04g1:650261:650325 [2] NCCL INFO Using network IB
tiger-i04g1:650262:650324 [3] NCCL INFO Using network IB
tiger-i04g1:650259:650323 [0] NCCL INFO Using non-device net plugin version 0
tiger-i04g1:650259:650323 [0] NCCL INFO Using network IB
tiger-i04g1:650260:650326 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ib0:10.36.54.40<0>
tiger-i04g1:650260:650326 [1] NCCL INFO Using non-device net plugin version 0
tiger-i04g1:650260:650326 [1] NCCL INFO Using network IB
tiger-i04g1:650262:650324 [3] NCCL INFO DMA-BUF is available on GPU device 3
tiger-i04g1:650261:650325 [2] NCCL INFO DMA-BUF is available on GPU device 2
tiger-i04g1:650259:650323 [0] NCCL INFO DMA-BUF is available on GPU device 0
tiger-i04g1:650260:650326 [1] NCCL INFO DMA-BUF is available on GPU device 1
tiger-i04g1:650260:650326 [1] NCCL INFO comm 0x9b3e0a0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 90000 commId 0xfa027acd2bce6195 - Init START
tiger-i04g1:650259:650323 [0] NCCL INFO comm 0xa123f90 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 87000 commId 0xfa027acd2bce6195 - Init START
tiger-i04g1:650261:650325 [2] NCCL INFO comm 0x91934d0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId b9000 commId 0xfa027acd2bce6195 - Init START
tiger-i04g1:650262:650324 [3] NCCL INFO comm 0x9a7cdc0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c2000 commId 0xfa027acd2bce6195 - Init START
tiger-i04g1:650260:650326 [1] NCCL INFO Setting affinity for GPU 1 to 0fffff,ff000000,00000000
tiger-i04g1:650260:650326 [1] NCCL INFO NVLS multicast support is available on dev 1
tiger-i04g1:650261:650325 [2] NCCL INFO Setting affinity for GPU 2 to 0fffff,ff000000,00000000
tiger-i04g1:650261:650325 [2] NCCL INFO NVLS multicast support is available on dev 2
tiger-i04g1:650262:650324 [3] NCCL INFO Setting affinity for GPU 3 to 0fffff,ff000000,00000000
tiger-i04g1:650259:650323 [0] NCCL INFO Setting affinity for GPU 0 to 0fffff,ff000000,00000000
tiger-i04g1:650262:650324 [3] NCCL INFO NVLS multicast support is available on dev 3
tiger-i04g1:650259:650323 [0] NCCL INFO NVLS multicast support is available on dev 0
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 00/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 01/24 :    0   1   2   3
tiger-i04g1:650262:650324 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2 [4] -1/-1/-1->3->2 [5] -1/-1/-1->3->2 [6] -1/-1/-1->3->2 [7] -1/-1/-1->3->2 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] -1/-1/-1->3->2 [11] -1/-1/-1->3->2 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] -1/-1/-1->3->2 [15] -1/-1/-1->3->2 [16] -1/-1/-1->3->2 [17] -1/-1/-1->3->2 [18] -1/-1/-1->3->2 [19] -1/-1/-1->3->2 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] -1/-1/-1->3->2 [23] -1/-1/-1->3->2
tiger-i04g1:650261:650325 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1 [4] 3/-1/-1->2->1 [5] 3/-1/-1->2->1 [6] 3/-1/-1->2->1 [7] 3/-1/-1->2->1 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] 3/-1/-1->2->1 [11] 3/-1/-1->2->1 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] 3/-1/-1->2->1 [15] 3/-1/-1->2->1 [16] 3/-1/-1->2->1 [17] 3/-1/-1->2->1 [18] 3/-1/-1->2->1 [19] 3/-1/-1->2->1 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] 3/-1/-1->2->1 [23] 3/-1/-1->2->1
tiger-i04g1:650260:650326 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0 [4] 2/-1/-1->1->0 [5] 2/-1/-1->1->0 [6] 2/-1/-1->1->0 [7] 2/-1/-1->1->0 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 2/-1/-1->1->0 [11] 2/-1/-1->1->0 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 2/-1/-1->1->0 [15] 2/-1/-1->1->0 [16] 2/-1/-1->1->0 [17] 2/-1/-1->1->0 [18] 2/-1/-1->1->0 [19] 2/-1/-1->1->0 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 2/-1/-1->1->0 [23] 2/-1/-1->1->0
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 02/24 :    0   1   2   3
tiger-i04g1:650262:650324 [3] NCCL INFO P2P Chunksize set to 524288
tiger-i04g1:650261:650325 [2] NCCL INFO P2P Chunksize set to 524288
tiger-i04g1:650260:650326 [1] NCCL INFO P2P Chunksize set to 524288
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 03/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 04/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 05/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 06/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 07/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 08/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 09/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 10/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 11/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 12/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 13/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 14/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 15/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 16/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 17/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 18/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 19/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 20/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 21/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 22/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 23/24 :    0   1   2   3
tiger-i04g1:650259:650323 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] 1/-1/-1->0->-1 [7] 1/-1/-1->0->-1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] 1/-1/-1->0->-1 [19] 1/-1/-1->0->-1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 1/-1/-1->0->-1 [23] 1/-1/-1->0->-1
tiger-i04g1:650259:650323 [0] NCCL INFO P2P Chunksize set to 524288
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 04/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 05/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 06/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 07/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 08/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 09/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 10/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 11/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 12/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 13/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 04/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 04/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 14/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 05/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 05/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 15/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 06/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 06/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 16/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 07/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 08/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 17/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 07/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 08/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 09/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 18/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 10/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 09/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 19/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 11/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 20/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 10/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 12/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 21/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 11/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 13/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 22/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 12/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 14/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 23/0 : 3[3] -> 0[0] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 15/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 13/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 16/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 14/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 17/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 15/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 18/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 16/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 19/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 17/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 20/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 18/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 21/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 19/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 22/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 20/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 23/0 : 1[1] -> 2[2] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 21/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 22/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 23/0 : 2[2] -> 3[3] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Connected all rings
tiger-i04g1:650259:650323 [0] NCCL INFO Connected all rings
tiger-i04g1:650261:650325 [2] NCCL INFO Connected all rings
tiger-i04g1:650262:650324 [3] NCCL INFO Connected all rings
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 04/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 05/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 06/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 07/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 08/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 09/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 10/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 11/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 12/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 13/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 14/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 15/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 16/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 17/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 18/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 19/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 20/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 21/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 22/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650262:650324 [3] NCCL INFO Channel 23/0 : 3[3] -> 2[2] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650260:650326 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 04/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 05/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 06/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 07/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 08/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 09/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 10/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 11/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 12/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 13/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 14/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 15/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 16/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 17/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 18/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 19/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 20/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 21/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 22/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650261:650325 [2] NCCL INFO Channel 23/0 : 2[2] -> 1[1] via P2P/CUMEM
tiger-i04g1:650259:650323 [0] NCCL INFO Connected all trees
tiger-i04g1:650260:650326 [1] NCCL INFO Connected all trees
tiger-i04g1:650261:650325 [2] NCCL INFO Connected all trees
tiger-i04g1:650262:650324 [3] NCCL INFO Connected all trees
tiger-i04g1:650259:650323 [0] NCCL INFO NVLS comm 0xa123f90 headRank 0 nHeads 4 buffSize 4194304 memSize 2097152 nvlsPerRankSize 201326592 nvlsTotalSize 805306368
tiger-i04g1:650261:650325 [2] NCCL INFO NVLS comm 0x91934d0 headRank 2 nHeads 4 buffSize 4194304 memSize 2097152 nvlsPerRankSize 201326592 nvlsTotalSize 805306368
tiger-i04g1:650262:650324 [3] NCCL INFO NVLS comm 0x9a7cdc0 headRank 3 nHeads 4 buffSize 4194304 memSize 2097152 nvlsPerRankSize 201326592 nvlsTotalSize 805306368
tiger-i04g1:650260:650326 [1] NCCL INFO NVLS comm 0x9b3e0a0 headRank 1 nHeads 4 buffSize 4194304 memSize 2097152 nvlsPerRankSize 201326592 nvlsTotalSize 805306368
tiger-i04g1:650260:650326 [1] NCCL INFO Connected NVLS tree
tiger-i04g1:650259:650323 [0] NCCL INFO Connected NVLS tree
tiger-i04g1:650262:650324 [3] NCCL INFO Connected NVLS tree
tiger-i04g1:650260:650326 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
tiger-i04g1:650260:650326 [1] NCCL INFO 24 coll channels, 16 nvls channels, 32 p2p channels, 32 p2p channels per peer
tiger-i04g1:650262:650324 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
tiger-i04g1:650262:650324 [3] NCCL INFO 24 coll channels, 16 nvls channels, 32 p2p channels, 32 p2p channels per peer
tiger-i04g1:650259:650323 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
tiger-i04g1:650259:650323 [0] NCCL INFO 24 coll channels, 16 nvls channels, 32 p2p channels, 32 p2p channels per peer
tiger-i04g1:650261:650325 [2] NCCL INFO Connected NVLS tree
tiger-i04g1:650261:650325 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
tiger-i04g1:650261:650325 [2] NCCL INFO 24 coll channels, 16 nvls channels, 32 p2p channels, 32 p2p channels per peer
tiger-i04g1:650260:650326 [1] NCCL INFO comm 0x9b3e0a0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 90000 commId 0xfa027acd2bce6195 - Init COMPLETE
tiger-i04g1:650262:650324 [3] NCCL INFO comm 0x9a7cdc0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c2000 commId 0xfa027acd2bce6195 - Init COMPLETE
tiger-i04g1:650261:650325 [2] NCCL INFO comm 0x91934d0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId b9000 commId 0xfa027acd2bce6195 - Init COMPLETE
tiger-i04g1:650259:650323 [0] NCCL INFO comm 0xa123f90 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 87000 commId 0xfa027acd2bce6195 - Init COMPLETE
2025-09-07 08:52:05,652 - INFO - Prognostic variables: CT_0, CT_1, CT_2, CT_3, CT_4, CT_5, CT_6, CT_7, CT_8, CT_9, CT_10, CT_11, CT_12, CT_13, CT_14, CT_15, CT_16, CT_17, CT_18, CT_19, CT_20, CT_21, CT_22, CT_23, CT_24, CT_25, CT_26, CT_27, CT_28, CT_29, CT_30, CT_31, CT_32, CT_33, CT_34, CT_35, CT_36, CT_37, CT_38, CT_39, CT_40, CT_41, CT_42, CT_43, SA_0, SA_1, SA_2, SA_3, SA_4, SA_5, SA_6, SA_7, SA_8, SA_9, SA_10, SA_11, SA_12, SA_13, SA_14, SA_15, SA_16, SA_17, SA_18, SA_19, SA_20, SA_21, SA_22, SA_23, SA_24, SA_25, SA_26, SA_27, SA_28, SA_29, SA_30, SA_31, SA_32, SA_33, SA_34, SA_35, SA_36, SA_37, SA_38, SA_39, SA_40, SA_41, SA_42, SA_43, o2_0, o2_1, o2_2, o2_3, o2_4, o2_5, o2_6, o2_7, o2_8, o2_9, o2_10, o2_11, o2_12, o2_13, o2_14, o2_15, o2_16, o2_17, o2_18, o2_19, o2_20, o2_21, o2_22, o2_23, o2_24, o2_25, o2_26, o2_27, o2_28, o2_29, o2_30, o2_31, o2_32, o2_33, o2_34, o2_35, o2_36, o2_37, o2_38, o2_39, o2_40, o2_41, o2_42, o2_43, dic_0, dic_1, dic_2, dic_3, dic_4, dic_5, dic_6, dic_7, dic_8, dic_9, dic_10, dic_11, dic_12, dic_13, dic_14, dic_15, dic_16, dic_17, dic_18, dic_19, dic_20, dic_21, dic_22, dic_23, dic_24, dic_25, dic_26, dic_27, dic_28, dic_29, dic_30, dic_31, dic_32, dic_33, dic_34, dic_35, dic_36, dic_37, dic_38, dic_39, dic_40, dic_41, dic_42, dic_43
2025-09-07 08:52:05,652 - INFO - Boundary variables: tauuo, tauvo, Qnet
2025-09-07 08:52:05,652 - INFO - Levels: 44
2025-09-07 08:52:05,657 - INFO - Number of inputs: (hist + 1) * prognostic_vars + boundary_vars = 355
2025-09-07 08:52:05,657 - INFO - Number of outputs: (hist + 1) * prognostic_vars = 352
2025-09-07 08:52:05,657 - INFO - Loading data
2025-09-07 08:52:08,110 - INFO - Instantiating model samudra_bgc
[08:52:08.126173] SamudraBGC init - Wet mask shape: torch.Size([352, 270, 180])
[08:52:08.126218] Expected spatial dims based on data: y=270, x=180
2025-09-07 08:52:11,407 - INFO - Loss = mse
2025-09-07 08:52:12,473 - INFO - Inference will use input at time 2024-01-01T00:00:00.000000000 and produce output at 2024-01-03T00:00:00.000000000
2025-09-07 08:52:12,489 - INFO - Starting training at step 4
2025-09-07 08:52:16,237 - INFO - Instantiating torch loaders
2025-09-07 09:06:52,574 - ERROR - An error occurred: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 1 has a total capacity of 139.80 GiB of which 437.19 MiB is free. Including non-PyTorch memory, this process has 139.37 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.09 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-09-07 09:06:52,602 - ERROR - Traceback (most recent call last):
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 624, in main
    trainer.run()
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 306, in run
    train_loss = self.train_one_epoch(epoch)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 358, in train_one_epoch
    TO: TrainOutput = Stepper.train_step(self.model, data, self.loss_fn)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/stepper.py", line 20, in train_step
    loss_per_channel = model(batch, loss_fn=loss_fn)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1523, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1359, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 270, in forward
    pred = self.forward_once(input_tensor)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 227, in forward_once
    fts = self.layers[decoder_start + i * 2](fts)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/blocks.py", line 174, in forward
    x = layer(x)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 1 has a total capacity of 139.80 GiB of which 437.19 MiB is free. Including non-PyTorch memory, this process has 139.37 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.09 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

tiger-i04g1:650259:650332 [0] NCCL INFO [Service thread] Connection closed by localRank 1
tiger-i04g1:650261:650333 [2] NCCL INFO [Service thread] Connection closed by localRank 1
2025-09-07 09:06:57,253 - ERROR - An error occurred: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 2 has a total capacity of 139.80 GiB of which 337.19 MiB is free. Including non-PyTorch memory, this process has 139.46 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.18 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-09-07 09:06:57,266 - ERROR - Traceback (most recent call last):
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 624, in main
    trainer.run()
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 306, in run
    train_loss = self.train_one_epoch(epoch)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 358, in train_one_epoch
    TO: TrainOutput = Stepper.train_step(self.model, data, self.loss_fn)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/stepper.py", line 20, in train_step
    loss_per_channel = model(batch, loss_fn=loss_fn)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1523, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1359, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 270, in forward
    pred = self.forward_once(input_tensor)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 227, in forward_once
    fts = self.layers[decoder_start + i * 2](fts)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/blocks.py", line 174, in forward
    x = layer(x)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 2 has a total capacity of 139.80 GiB of which 337.19 MiB is free. Including non-PyTorch memory, this process has 139.46 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.18 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-09-07 09:06:57,291 - ERROR - An error occurred: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 0 has a total capacity of 139.80 GiB of which 407.19 MiB is free. Including non-PyTorch memory, this process has 139.39 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.16 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-09-07 09:06:57,295 - ERROR - Traceback (most recent call last):
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 624, in main
    trainer.run()
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 306, in run
    train_loss = self.train_one_epoch(epoch)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/train.py", line 358, in train_one_epoch
    TO: TrainOutput = Stepper.train_step(self.model, data, self.loss_fn)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/stepper.py", line 20, in train_step
    loss_per_channel = model(batch, loss_fn=loss_fn)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1523, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1359, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 270, in forward
    pred = self.forward_once(input_tensor)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/samudra_bgc.py", line 227, in forward_once
    fts = self.layers[decoder_start + i * 2](fts)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/gpfs/GEOCLIM/LRGROUP/maximek/INMOS/samudra-bgc/src/models/blocks.py", line 174, in forward
    x = layer(x)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mk0964/.conda/envs/samudra/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 476.00 MiB. GPU 0 has a total capacity of 139.80 GiB of which 407.19 MiB is free. Including non-PyTorch memory, this process has 139.39 GiB memory in use. Of the allocated memory 135.37 GiB is allocated by PyTorch, and 1.16 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

tiger-i04g1:650259:650332 [0] NCCL INFO [Service thread] Connection closed by localRank 2
tiger-i04g1:650262:650334 [3] NCCL INFO [Service thread] Connection closed by localRank 2
tiger-i04g1:650262:650334 [3] NCCL INFO [Service thread] Connection closed by localRank 0
